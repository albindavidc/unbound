<%- include("../../views/partials/admin/header") %>

<style>
  .userProfileMain {
    width: 100%;
    height: 30%;
    margin: 0 auto;
    background-color: rgb(0, 0, 0);
  }

  .userProfileH1 {
    width: 100%;
    margin: 10px;
    font-family: "Baloo", cursive;
    color: white;
    font-size: 6vw;
  }

  .breadcrumbCls {
    background-color: rgb(0, 0, 0);
  }

  body {
    background-color: #121212;
    color: #e0e0e0;
    font-family: "Roboto", sans-serif;
  }

  .card-body {
    padding: 20px;
  }

  .icontext .icon {
    background-color: #2a2a2a;
    color: #ffffff;
  }

  .icontext .text h6 {
    color: #ffffff;
  }

  .icontext .text span {
    color: #bdbdbd;
    font-size: 1.2rem;
  }

  .icontext .icon:hover {
    background-color: #ffffff;
    color: #1f1f1f;
    transition: all 0.3s ease-in-out;
  }

  .card-title {
    font-size: 1rem;
    margin-bottom: 10px;
    font-weight: bold;
  }

  .card:hover {
    transform: translateY(-5px);
    transition: all 0.3s ease-in-out;
  }

  .content-main {
    padding: 30px;
  }

  @media (max-width: 768px) {
    .card-body {
      padding: 15px;
    }
  }
</style>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>


<section>
  <div class="pb-5 text-center">
    <div class="card userProfileMain rounded">
      <h1 class="userProfileH1">Dashboard</h1>
    </div>
  </div>
</section>

<section class="content-main">
  <div class="row">
    <!-- Total Users Card -->
    <div class="col-lg-3 col-md-6 col-sm-12">
      <div class="card card-body mb-4">
        <article class="icontext">
          <span class="icon icon-sm rounded-circle">
            <i class="material-icons md-people"></i>
          </span>
          <div class="text">
            <h6 class="mb-1 card-title">Total Users</h6>
            <span><%- userCount %></span>
          </div>
        </article>
      </div>
    </div>

    <!-- Total Products Card -->
    <div class="col-lg-3 col-md-6 col-sm-12">
      <div class="card card-body mb-4">
        <article class="icontext">
          <span class="icon icon-sm rounded-circle">
            <i class="material-icons md-shopping_bag"></i>
          </span>
          <div class="text">
            <h6 class="mb-1 card-title">Total Products</h6>
            <span><%- productCount %></span>
          </div>
        </article>
      </div>
    </div>

    <!-- Other Cards Here -->
  </div>

  <div class="row">
    <div id="piechart"></div>
    <div>

      <canvas id="myChart" style="width:100%;max-width:600px"></canvas>
    </div>

  </div>
  
</section>

<script type="text/javascript">
    // Load google charts
    google.charts.load("current", { packages: ["corechart"] });
    google.charts.setOnLoadCallback(drawChart);

   // Pass the order array from backend as a valid JSON object directly
  const paymentMethod = JSON.parse('<%- JSON.stringify(order) %>');

  console.log("this is frontEnd payment method", paymentMethod);

  // Draw the chart and set the chart values
  function drawChart() {
    // Initialize the array with headers
    const chartData = [
      ["Payment Method", "User Count"]
    ];

    // Loop through payment methods and add each as an array
    paymentMethod.forEach(method => {
      chartData.push([method.paymentMethod, method.userCount]);
    });

      // Now pass the built chartData to google.visualization.arrayToDataTable
      var data = google.visualization.arrayToDataTable(chartData);

      var options = { title: "All payment methods used by users", width: 550, height: 400 };

      // Display the chart inside the <div> element with id="piechart"
      var chart = new google.visualization.PieChart(document.getElementById("piechart"));
      chart.draw(data, options);
    }
</script>

<script>
const xValues = ["Italy", "France", "Spain", "USA", "Argentina"];
const yValues = [55, 49, 44, 24, 15];
const barColors = ["red", "green","blue","orange","brown"];

const paymentMethodBar = JSON.parse('<%- JSON.stringify(orderBar) %>');


new Chart("myChart", {
  type: "bar",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    legend: {display: false},
    title: {
      display: true,
      text: "World Wine Production 2018"
    }
  }
});
</script>

<%- include("../../views/partials/admin/footer") %>
